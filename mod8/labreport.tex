\documentclass[11pt]{article}

\usepackage{graphicx}
\usepackage{framed}
\usepackage{hyperref}
\usepackage{listings}
\usepackage{xcolor}
\usepackage{caption}
\usepackage{subcaption}

\usepackage{booktabs}
\usepackage{amsmath}

\marginparwidth 0.5in 
\oddsidemargin 0.25in 
\evensidemargin 0.25in 
\marginparsep 0.25in
\topmargin 0.25in 
\textwidth=6in
\textheight=8in

\definecolor{codegreen}{rgb}{0,0.6,0}
\definecolor{codegray}{rgb}{0.5,0.5,0.5}
\definecolor{codepurple}{rgb}{0.58,0,0.82}
\definecolor{backcolor}{rgb}{0.95,0.95,0.95}

\lstset{
  backgroundcolor=\color{backcolor}, % Set background color
  commentstyle=\color{codegreen}, % Style for comments
  keywordstyle=\color{magenta}, % Style for keywords
  numberstyle=\tiny\color{codegray}, % Style for line numbers
  stringstyle=\color{codepurple}, % Style for strings
  basicstyle=\ttfamily\footnotesize, % Basic font style and size
  breakatwhitespace=false, % Don't break lines at whitespace only
  breaklines=true, % Enable line breaking
  captionpos=b, % Caption position (bottom)
  keepspaces=true, % Keep spaces
  numbers=left, % Show line numbers on the left
  numbersep=5pt, % Separation of numbers from code
  showspaces=false, % Don't show spaces as visible characters
  showstringspaces=false, % Don't show spaces in strings
  showtabs=false, % Don't show tabs as visible characters
  tabsize=2, % Tab size
  % language=Python % Specify the language
}

\begin{document}
\hfill\vbox{\hbox{Jude Shin, Torrey Zachs}
		\hbox{CSC 321, Section 07}	
		\hbox{Module 8}	
		\hbox{\today}}\par

\bigskip
\centerline{\Large\bf Lab 8: Natas}\par
\bigskip

This lab completes the OverTheWire CTF: Natas through level 16. A link to the game can be found \href{https://overthewire.org/wargames/natas/}{here}.

% ============================================================================

\section*{Commands, Passwords and Walk-through}
\subsection*{Level 0}
Password: 0nzCigAq7t2iALyvU9xcHlYN4MlkIwlq
Unlike other ctfs, this one is located on a website. 
The first login is from \href{http://natas0.natas.labs.overthewire.org}{http://natas0.natas.labs.overthewire.org}. Logging in with the default credentials on the popup as Username: natas0 and Password: natas0. 

When inspecting the javascript in the page, there was a comment in the main source code noting the password for the next level. 

\begin{verbatim}
<!--The password for natas1 is 0nzCigAq7t2iALyvU9xcHlYN4MlkIwlq -->
\end{verbatim}

\subsection*{Level 1}
Password: TguMNxKo1DSa1tujBLuZJnDUlCcUAPlI

The login is from \href{http://natas1.natas.labs.overthewire.org}{http://natas1.natas.labs.overthewire.org}. I logged in with the previously found credentials. 

I used the same exact technique as level 1. \verb|ctrl+shift+i| to inspect the page, and then the password was found at the bottom of the source code. 

\begin{verbatim}
<!--The password for natas2 is TguMNxKo1DSa1tujBLuZJnDUlCcUAPlI -->
\end{verbatim}

\subsection*{Level 2}
Password: 3gqisGdR0pjm6tpkDKdIWO2hSvchLeYH

The login is from \href{http://natas2.natas.labs.overthewire.org}{http://natas2.natas.labs.overthewire.org}. I logged in with the previously found credentials. 

At first I thought that the pixel.png had something to do with it. Because it was so small I thought that there might be some text embedded in the image if I opened it in a utf-8 buffer, but it did not show anything important. 

The url that the file was located at (\verb|http://natas2.natas.labs.overthewire.org/files/pixel.png|) also showed that there was a directory called \verb|files|. Going to that url (\verb|http://natas2.natas.labs.overthewire.org/files/|) sent me to a website that also had a directory with a file called \verb|users.txt|. These lines were the contents of the file. 

\begin{verbatim}
# username:password
alice:BYNdCesZqW
bob:jw2ueICLvT
charlie:G5vCxkVV3m
natas3:3gqisGdR0pjm6tpkDKdIWO2hSvchLeYH
eve:zo4mJWyNj2
mallory:9urtcpzBmH
\end{verbatim}

It clearly lays out the password for the \verb|natas3|.

\subsection*{Level 3}
Password: QryZXc2e0zahULdHrtHxzyYkj59kUxLQ

The login is from \href{http://natas3.natas.labs.overthewire.org}{http://natas3.natas.labs.overthewire.org}. I logged in with the previously found credentials. 

I looked at the hints, and it says that "Not even Google can find it" is a reference to a file robots.txt that gives parameters on what search engines are and aren't allowed to crawl through. I tried to append that filename to the end of the url (giving me \verb|http://natas3.natas.labs.overthewire.org/robots.txt|) and found the following contents:

\begin{verbatim}
User-agent: *
Disallow: /s3cr3t/
\end{verbatim}

I assumed that the directory \verb|/s3cr3t/| was actually present (if they were trying to disallow it), so I went to the url \verb|http://natas3.natas.labs.overthewire.org/s3cr3t| and there was yet another \verb|users.txt| with the following contents.

\begin{verbatim}
natas4:QryZXc2e0zahULdHrtHxzyYkj59kUxLQ
\end{verbatim}

\subsection*{Level 4}
Password: 0n35PkggAPm2zbEpOU802c0x0Msn1ToK

The login is from \href{http://natas4.natas.labs.overthewire.org}{http://natas4.natas.labs.overthewire.org}. I logged in with the previously found credentials. 

This time, I opened up BurpSuite, which allowed me to intercept all traffic going in and out using a proxy. This meant that when sending a page, I can edit the contents before sending it out. In this case, when we clicked the \verb|refresh page|, button, it would give a message like the following:. 

\begin{verbatim}
Access disallowed. You are visiting from "http://natas4.natas.labs.overthewire.org/index.php" while authorized users should come only from "http://natas5.natas.labs.overthewire.org/"
\end{verbatim}

When I intercepted the traffic of the refresh GET request, I saw that the bottom of the request had a \verb|Referer| section. I set this to be \verb|http://natas5.natas.labs.overthewire.org/|. 

\begin{verbatim}
GET /index.php HTTP/1.1
Host: natas4.natas.labs.overthewire.org
Authorization: Basic bmF0YXM0OlFyeVpYYzJlMHphaFVMZEhydEh4enlZa2o1OWtVeExR
Accept-Language: en-US,en;q=0.9
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Referer: http://natas4.natas.labs.overthewire.org/index.php
Accept-Encoding: gzip, deflate, br
Connection: keep-alive
\end{verbatim}

I forwarded the edited request, and this was the result:

\begin{verbatim}
Access granted. The password for natas5 is 0n35PkggAPm2zbEpOU802c0x0Msn1ToK
\end{verbatim}

\subsection*{Level 5}
Password: 0RoJwHdSKWFTYR5WuiAewauSuNaBXned

The login is from \href{http://natas5.natas.labs.overthewire.org}{http://natas5.natas.labs.overthewire.org}. I logged in with the previously found credentials. 

I again opened up BurpSuite, which allowed me to intercept all traffic going in and out using a proxy. This meant that when sending a page, I can edit the contents before sending it out. In this case, when I logged in, I was greeted with a message that I was not logged in. This did not make any sense, as I just used the correct credentials. I refreshed the page and looked at the contents of the request. This is what I found (note the attribute at the bottom that says \verb|loggedin|)

\begin{verbatim}
GET / HTTP/1.1
Host: natas5.natas.labs.overthewire.org
Cache-Control: max-age=0
Authorization: Basic bmF0YXM1OjBuMzVQa2dnQVBtMnpiRXBPVTgwMmMweDBNc24xVG9L
Accept-Language: en-US,en;q=0.9
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Accept-Encoding: gzip, deflate, br
Cookie: loggedin=0
Connection: keep-alive
\end{verbatim}

I changed the \verb|Cookie: loggedin=0| to \verb|Cookie: loggedin=1|, and forwarded the request. The new password page with the credentials are now shown. In response to this.

\begin{verbatim}
Access granted. The password for natas6 is 0RoJwHdSKWFTYR5WuiAewauSuNaBXned
\end{verbatim}


\subsection*{Level 6}
Password: 


\subsection*{Level 7}
Password: 

\subsection*{Level 8}
Password: 

\subsection*{Level 9}
Password: 

\subsection*{Level 10}
Password: 

\subsection*{Level 11}
Password: 

\subsection*{Level 12}
Password: 

\subsection*{Level 13}
Password: 

\subsection*{Level 14}
Password: 

\subsection*{Level 15}
Password: 

\subsection*{Level 16}
Password: 


\end{document}
